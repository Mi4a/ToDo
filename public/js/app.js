const app=angular.module("app",["ngRoute","route-segment","view-segment","ngResource","ngAnimate","toastr"]);app.config(function(o){o.when("/","start").when("/todo","todo").when("/new","new").segment("start",{default:!0,templateUrl:"../HTML/start.html"}).segment("todo",{templateUrl:"../HTML/todoListTemplate.html",controller:"todoListController"}).segment("new",{templateUrl:"../HTML/newTodoTemplate.html",controller:"newTodoController"})}),app.directive("loginForm",function(){return{restrict:"E",templateUrl:"../HTML/loginTemplate.html",controller:"loginController",controllerAs:"log"}}),app.controller("loginController",function(o,e,t,n,r){o.name=t.userName||!1,o.username="",o.password="",o.dataLoading=!1,o.login=function(){o.userLogin=n("/users/login"),o.userLogin.get({username:t.username,password:o.password},function(n){n!=={}?(t.userName=n.username,o.dataLoading=!1,e.path("/todo")):(o.dataLoading=!1,r.error("Some error happened! Try enter login/password one more time!","Error"))},function(e){console.log(e),o.dataLoading=!1,r.error("Invalid login/password! Please try again!","Error")})},o.registration=function(){o.userReg=n("/users/registration"),o.userReg.save({},{username:o.username,password:o.password},function(o){console.log(o),r.success("Thank you for registration!")},function(e){o.dataLoading=!1,console.log(e),r.warning("User already exist","Warning")})}}),app.controller("newTodoController",function(o,e,t,n,r){o.todoId=n.todoId||!1,o.newTodo="",o.username=n.userName||!1,o.cancel=function(){t.path("/todo")},o.createNewTodo=function(){let n={username:o.username,description:o.newTodo};o.todoId&&(n.id=o.todoId),o.userReg=e("/todo"),o.userReg.save({},n,function(e){console.log(e),o.newTodo="",r.success("We write your ToDo","All is OK!"),t.path("/todo")},function(o){console.log(o),r.error("New Todo not added! Sorry!","Error")})}}),app.controller("todoListController",function(o,e,t,n,r){o.todoList=[],o.userName=t.userName||"Someones",o.getTodos=n("/todo/:username"),o.getTodos.query({username:t.userName},function(e){o.todoList=e,console.log(e)},function(o){console.log(o),r.error("We cant find your ToDO`s","Error")}),o.createNewTodo=function(){e.path("/new")},o.editTodo=function(o){t.todoId=o,e.path("/new")},o.delete=function(e){let t=o.todoList.indexOf(e);o.delTodos=n("/todo/:id"),o.delTodos.delete({id:e.id},function(e){console.log(e),r.info("Todo deleted!","Information"),o.todoList.splice(t,1)},function(o){console.log(o),r.warning("We cant delete this","Warning")})}}),app.directive("logoutButton",function(){return{restrict:"E",templateUrl:"../HTML/logoutButtonTemplate.html",controller:"logoutController"}}),app.controller("logoutController",function(o,e,t,n,r){o.logout=function(){o.logout=t("/users/logout"),o.logout.get({},function(){console.log("Logout succeed"),n.userName=!1,e.path("/")},function(){r.error("Logout went wrong","Error")})}});