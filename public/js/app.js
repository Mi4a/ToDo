const app=angular.module("app",["ngRoute","ngResource"]);app.config(function(o){o.when("/",{templateUrl:"../HTML/start.html",controller:""}).when("/todo",{templateUrl:"../HTML/todoListTemplate.html",controller:""}).when("/new",{templateUrl:"../HTML/newTodoTemplate.html",controller:""}).otherwise({redirectTo:"/"})}),app.directive("loginForm",function(){return{restrict:"E",templateUrl:"../HTML/loginTemplate.html",controller:"loginController",controllerAs:"log"}}),app.controller("loginController",function(o,e,t,n,r){o.name=t.userName||!1,o.username="",o.password="",o.dataLoading=!1,o.login=function(){o.userLogin=r("/users/login"),o.userLogin.get({username:t.username,password:o.password},function(n){console.log("res:",n),n!=={}?(t.userName=n.username,console.log(t.userName),o.dataLoading=!1,e.path("/todo")):(o.dataLoading=!1,alert("Some error happened! Try enter login/password one more time!"))},function(e){console.log(e),o.dataLoading=!1,alert("Invalid login/password! Please try again!")})},o.registration=function(){o.userReg=r("/users/registration"),o.userReg.save({},{username:o.username,password:o.password},function(o){console.log(o),alert("Thank you for registration!")},function(e){o.dataLoading=!1,console.log(e),alert("User already exist")})}}),app.controller("newTodoController",function(o,e,t,n){o.todoId=n.todoId||!1,o.newTodo="",o.username=n.userName||!1,o.cancel=function(){t.path("/todo")},o.createNewTodo=function(){let n={username:o.username,description:o.newTodo};o.todoId&&(n.id=o.todoId),o.userReg=e("/todo"),o.userReg.save({},n,function(e){console.log(e),o.newTodo="",alert("New Todo added!"),t.path("/todo")},function(o){console.log(o),alert("New Todo not added! Sorry!")})}}),app.controller("todoListController",function(o,e,t,n,r){o.todoList=[],o.userName=n.userName||"Someones",o.getTodos=r("/todo/:username"),o.getTodos.query({username:n.userName},function(e){o.todoList=e},function(o){console.log(o)}),o.createNewTodo=function(){t.path("/new")},o.editTodo=function(o){n.todoId=o,t.path("/new")},o.delete=function(e){let t=o.todoList.indexOf(e);o.delTodos=r("/todo/:id"),o.delTodos.delete({id:e.id},function(e){console.log(e),alert("Todo deleted!"),o.todoList.splice(t,1)},function(o){console.log(o),alert("We cant delete this")})}}),app.directive("logoutButton",function(){return{restrict:"E",templateUrl:"../HTML/logoutButtonTemplate.html",controller:"logoutController"}}),app.controller("logoutController",function(o,e,t,n){o.logout=function(){o.logout=t("/users/logout"),o.logout.get({},function(){console.log("Logout succeed"),n.userName=!1,e.path("/")},function(){console.log("Logout went wrong")})}});