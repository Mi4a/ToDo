const app=angular.module("app",["ngRoute","ngResource","ngAnimate","toastr"]);app.config(function(o){o.when("/",{templateUrl:"../HTML/start.html",controller:""}).when("/todo",{templateUrl:"../HTML/todoListTemplate.html",controller:""}).when("/new",{templateUrl:"../HTML/newTodoTemplate.html",controller:""}).otherwise({redirectTo:"/"})}),app.directive("loginForm",function(){return{restrict:"E",templateUrl:"../HTML/loginTemplate.html",controller:"loginController",controllerAs:"log"}}),app.controller("loginController",function(o,e,n,t,r){o.name=n.userName||!1,o.username="",o.password="",o.dataLoading=!1,o.login=function(){o.userLogin=t("/users/login"),o.userLogin.get({username:n.username,password:o.password},function(t){t!=={}?(n.userName=t.username,o.dataLoading=!1,e.path("/todo")):(o.dataLoading=!1,r.error("Some error happened! Try enter login/password one more time!","Error"))},function(e){console.log(e),o.dataLoading=!1,r.error("Invalid login/password! Please try again!","Error")})},o.registration=function(){o.userReg=t("/users/registration"),o.userReg.save({},{username:o.username,password:o.password},function(o){console.log(o),r.success("Thank you for registration!")},function(e){o.dataLoading=!1,console.log(e),r.warning("User already exist","Warning")})}}),app.controller("newTodoController",function(o,e,n,t,r){o.todoId=t.todoId||!1,o.newTodo="",o.username=t.userName||!1,o.cancel=function(){n.path("/todo")},o.createNewTodo=function(){let t={username:o.username,description:o.newTodo};o.todoId&&(t.id=o.todoId),o.userReg=e("/todo"),o.userReg.save({},t,function(e){console.log(e),o.newTodo="",r.success("We write your ToDo","All is OK!"),n.path("/todo")},function(o){console.log(o),r.error("New Todo not added! Sorry!","Error")})}}),app.controller("todoListController",function(o,e,n,t,r){o.todoList=[],o.userName=n.userName||"Someones",o.getTodos=t("/todo/:username"),o.getTodos.query({username:n.userName},function(e){o.todoList=e,console.log(e)},function(o){console.log(o),r.error("We cant find your ToDO`s","Error")}),o.createNewTodo=function(){e.path("/new")},o.editTodo=function(o){n.todoId=o,e.path("/new")},o.delete=function(e){let n=o.todoList.indexOf(e);o.delTodos=t("/todo/:id"),o.delTodos.delete({id:e.id},function(e){console.log(e),r.info("Todo deleted!","Information"),o.todoList.splice(n,1)},function(o){console.log(o),r.warning("We cant delete this","Warning")})}}),app.directive("logoutButton",function(){return{restrict:"E",templateUrl:"../HTML/logoutButtonTemplate.html",controller:"logoutController"}}),app.controller("logoutController",function(o,e,n,t,r){o.logout=function(){o.logout=n("/users/logout"),o.logout.get({},function(){console.log("Logout succeed"),t.userName=!1,e.path("/")},function(){r.error("Logout went wrong","Error")})}});